syntax = "proto3";

package spine.validation;

import "spine/options.proto";

option (type_url_prefix) = "type.spine.io";
option java_package = "io.spine.validation";
option java_outer_classname = "FieldViewsProto";
option java_multiple_files = true;

import "spine/protodata/ast.proto";

// Uniquely identifies a message field declaration.
message FieldId {

    // The name of the containing type.
    protodata.TypeName type = 1;

    // The name of the field.
    protodata.FieldName name = 2;
}

// A view on a field that is marked with `(required) = true`.
message RequiredField {
    option (entity).kind = PROJECTION;

    FieldId id = 1;

    // The error message template.
    string error_message = 2;

    // The field in which the option was discovered.
    protodata.Field subject = 3;
}

// A view on a field that is marked with `(validate)`.
message ValidatedField {
    option (entity).kind = PROJECTION;

    FieldId id = 1;

    // Deprecated: this option does not have its own error message.
    string error_message = 2 [deprecated = true];

    // `true` if the field is marked with `(validate) = true`, `false` otherwise.
    bool validate = 3;
}

// A view of a field that is marked with `(set_once)` option.
message SetOnceField {
    option (entity).kind = PROJECTION;

    FieldId id = 1;

    // The error message template.
    string error_message = 2;

    // `true` if the field is marked with `(set_once) = true`, `false` otherwise.
    bool set_once = 3;

    // The field in which the option was discovered.
    protodata.Field subject = 4;
}
